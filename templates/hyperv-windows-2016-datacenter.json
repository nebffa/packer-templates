{
    "builders": [
        {
            "type": "hyperv-iso",
            "guest_additions_mode": "disable",
            "iso_url": "{{ user `iso_url` }}",
            "iso_checksum": "{{ user `iso_checksum` }}",
            "iso_checksum_type": "md5",
            "cpu": 2,
            "ram_size": 4096,
            "vm_name": "windows-server-2016-packer",
            "output_directory": "{{ user `output_directory` }}",
            "communicator": "winrm",
            "winrm_username": "vagrant",
            "winrm_password": "vagrant",
            "winrm_timeout": "15m",
            "shutdown_command": "A:/packer_shutdown.bat",
            "shutdown_timeout": "30m",
            "switch_name": "internal_switch",
            "floppy_files": [
                "unattend_files/windows_server_2016/Autounattend.xml",
                "unattend_files/windows_server_2016/Post_Autounattend.xml",
                "scripts/winrm.ps1",
                "scripts/packer_shutdown.bat"
            ]
        }
    ],
    "provisioners": [
        {
            "type": "powershell",
            "inline": [
                "winrm quickconfig -quiet -force"
            ],
            "elevated_user": "vagrant",
            "elevated_password": "vagrant"
        }
    ],
    "post-processors": [
        {
            "type": "vagrant",
            "keep_input_artifact": true,
            "output": "{{env `IMAGES_DIR`}}/windows-2016-datacenter-hyper-v.box"
        }
    ],
    "variables": {
        "iso_checksum": "70721288bbcdfe3239d8f8c0fae55f1f",
        "iso_url": "{{env `IMAGES_DIR`}}/Windows_Server_2016.iso",
        "output_directory": "{{env `IMAGES_DIR`}}/Packer"
    }
}